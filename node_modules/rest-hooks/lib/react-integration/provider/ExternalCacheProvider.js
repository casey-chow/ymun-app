import _jsx from "@babel/runtime/helpers/esm/jsx";
import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import React, { useEffect, useState } from 'react';
import { StateContext, DispatchContext } from "../context";
import usePromisifiedDispatch from './usePromisifiedDispatch';
export default function ExternalCacheProvider(_ref) {
  var children = _ref.children,
      store = _ref.store,
      selector = _ref.selector;

  var _useState = useState(function () {
    return selector(store.getState());
  }),
      _useState2 = _slicedToArray(_useState, 2),
      state = _useState2[0],
      setState = _useState2[1];

  useEffect(function () {
    var unsubscribe = store.subscribe(function () {
      setState(selector(store.getState()));
    });
    return unsubscribe; // we don't care to recompute if they change selector - only when store updates
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [store]);
  var dispatch = usePromisifiedDispatch(store.dispatch, state);
  return _jsx(DispatchContext.Provider, {
    value: dispatch
  }, void 0, _jsx(StateContext.Provider, {
    value: state
  }, void 0, children));
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yZWFjdC1pbnRlZ3JhdGlvbi9wcm92aWRlci9FeHRlcm5hbENhY2hlUHJvdmlkZXIudHN4Il0sIm5hbWVzIjpbIlJlYWN0IiwidXNlRWZmZWN0IiwidXNlU3RhdGUiLCJTdGF0ZUNvbnRleHQiLCJEaXNwYXRjaENvbnRleHQiLCJ1c2VQcm9taXNpZmllZERpc3BhdGNoIiwiRXh0ZXJuYWxDYWNoZVByb3ZpZGVyIiwiY2hpbGRyZW4iLCJzdG9yZSIsInNlbGVjdG9yIiwiZ2V0U3RhdGUiLCJzdGF0ZSIsInNldFN0YXRlIiwidW5zdWJzY3JpYmUiLCJzdWJzY3JpYmUiLCJkaXNwYXRjaCJdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPQSxLQUFQLElBQTJCQyxTQUEzQixFQUFzQ0MsUUFBdEMsUUFBc0QsT0FBdEQ7QUFDQSxTQUFTQyxZQUFULEVBQXVCQyxlQUF2QixRQUE4QyxZQUE5QztBQUVBLE9BQU9DLHNCQUFQLE1BQW1DLDBCQUFuQztBQWFBLGVBQWUsU0FBU0MscUJBQVQsT0FJRjtBQUFBLE1BSFhDLFFBR1csUUFIWEEsUUFHVztBQUFBLE1BRlhDLEtBRVcsUUFGWEEsS0FFVztBQUFBLE1BRFhDLFFBQ1csUUFEWEEsUUFDVzs7QUFBQSxrQkFDZVAsUUFBUSxDQUFDO0FBQUEsV0FBTU8sUUFBUSxDQUFDRCxLQUFLLENBQUNFLFFBQU4sRUFBRCxDQUFkO0FBQUEsR0FBRCxDQUR2QjtBQUFBO0FBQUEsTUFDSkMsS0FESTtBQUFBLE1BQ0dDLFFBREg7O0FBR1hYLEVBQUFBLFNBQVMsQ0FBQyxZQUFNO0FBQ2QsUUFBTVksV0FBVyxHQUFHTCxLQUFLLENBQUNNLFNBQU4sQ0FBZ0IsWUFBTTtBQUN4Q0YsTUFBQUEsUUFBUSxDQUFDSCxRQUFRLENBQUNELEtBQUssQ0FBQ0UsUUFBTixFQUFELENBQVQsQ0FBUjtBQUNELEtBRm1CLENBQXBCO0FBR0EsV0FBT0csV0FBUCxDQUpjLENBS2Q7QUFDQTtBQUNELEdBUFEsRUFPTixDQUFDTCxLQUFELENBUE0sQ0FBVDtBQVNBLE1BQU1PLFFBQVEsR0FBR1Ysc0JBQXNCLENBQUNHLEtBQUssQ0FBQ08sUUFBUCxFQUFpQkosS0FBakIsQ0FBdkM7QUFFQSxTQUNFLEtBQUMsZUFBRCxDQUFpQixRQUFqQjtBQUEwQixJQUFBLEtBQUssRUFBRUk7QUFBakMsYUFDRSxLQUFDLFlBQUQsQ0FBYyxRQUFkO0FBQXVCLElBQUEsS0FBSyxFQUFFSjtBQUE5QixhQUFzQ0osUUFBdEMsQ0FERixDQURGO0FBS0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHsgUmVhY3ROb2RlLCB1c2VFZmZlY3QsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgU3RhdGVDb250ZXh0LCBEaXNwYXRjaENvbnRleHQgfSBmcm9tICd+L3JlYWN0LWludGVncmF0aW9uL2NvbnRleHQnO1xuaW1wb3J0IHsgU3RhdGUsIEFjdGlvblR5cGVzIH0gZnJvbSAnfi90eXBlcyc7XG5pbXBvcnQgdXNlUHJvbWlzaWZpZWREaXNwYXRjaCBmcm9tICcuL3VzZVByb21pc2lmaWVkRGlzcGF0Y2gnO1xuXG5pbnRlcmZhY2UgU3RvcmU8Uz4ge1xuICBzdWJzY3JpYmUobGlzdGVuZXI6ICgpID0+IHZvaWQpOiAoKSA9PiB2b2lkO1xuICBkaXNwYXRjaDogUmVhY3QuRGlzcGF0Y2g8QWN0aW9uVHlwZXM+O1xuICBnZXRTdGF0ZSgpOiBTO1xufVxuaW50ZXJmYWNlIFByb3BzPFM+IHtcbiAgY2hpbGRyZW46IFJlYWN0Tm9kZTtcbiAgc3RvcmU6IFN0b3JlPFM+O1xuICBzZWxlY3RvcjogKHN0YXRlOiBTKSA9PiBTdGF0ZTx1bmtub3duPjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRXh0ZXJuYWxDYWNoZVByb3ZpZGVyPFM+KHtcbiAgY2hpbGRyZW4sXG4gIHN0b3JlLFxuICBzZWxlY3Rvcixcbn06IFByb3BzPFM+KSB7XG4gIGNvbnN0IFtzdGF0ZSwgc2V0U3RhdGVdID0gdXNlU3RhdGUoKCkgPT4gc2VsZWN0b3Ioc3RvcmUuZ2V0U3RhdGUoKSkpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgY29uc3QgdW5zdWJzY3JpYmUgPSBzdG9yZS5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgc2V0U3RhdGUoc2VsZWN0b3Ioc3RvcmUuZ2V0U3RhdGUoKSkpO1xuICAgIH0pO1xuICAgIHJldHVybiB1bnN1YnNjcmliZTtcbiAgICAvLyB3ZSBkb24ndCBjYXJlIHRvIHJlY29tcHV0ZSBpZiB0aGV5IGNoYW5nZSBzZWxlY3RvciAtIG9ubHkgd2hlbiBzdG9yZSB1cGRhdGVzXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBbc3RvcmVdKTtcblxuICBjb25zdCBkaXNwYXRjaCA9IHVzZVByb21pc2lmaWVkRGlzcGF0Y2goc3RvcmUuZGlzcGF0Y2gsIHN0YXRlKTtcblxuICByZXR1cm4gKFxuICAgIDxEaXNwYXRjaENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2Rpc3BhdGNofT5cbiAgICAgIDxTdGF0ZUNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e3N0YXRlfT57Y2hpbGRyZW59PC9TdGF0ZUNvbnRleHQuUHJvdmlkZXI+XG4gICAgPC9EaXNwYXRjaENvbnRleHQuUHJvdmlkZXI+XG4gICk7XG59XG4iXX0=