import _toConsumableArray from "@babel/runtime/helpers/esm/toConsumableArray";
import _slicedToArray from "@babel/runtime/helpers/esm/slicedToArray";
import { useDenormalized } from "../../state/selectors";
import useRetrieve from './useRetrieve';
import useError from './useError';
import { useMemo, useContext } from 'react';
import { StateContext } from "../context";
import hasUsableData from './hasUsableData';

/** single form resource */
function useOneResource(fetchShape, params) {
  var maybePromise = useRetrieve(fetchShape, params);
  var state = useContext(StateContext);

  var _useDenormalized = useDenormalized(fetchShape, params, state),
      _useDenormalized2 = _slicedToArray(_useDenormalized, 2),
      denormalized = _useDenormalized2[0],
      ready = _useDenormalized2[1];

  var error = useError(fetchShape, params, ready);
  if (!hasUsableData(ready, fetchShape) && maybePromise) throw maybePromise;
  if (error) throw error;
  return denormalized;
}
/** many form resource */


function useManyResources() {
  for (var _len = arguments.length, resourceList = new Array(_len), _key = 0; _key < _len; _key++) {
    resourceList[_key] = arguments[_key];
  }

  var state = useContext(StateContext);
  var denormalizedValues = resourceList.map(function (_ref) {
    var _ref2 = _slicedToArray(_ref, 2),
        fetchShape = _ref2[0],
        params = _ref2[1];

    return (// eslint-disable-next-line react-hooks/rules-of-hooks
      useDenormalized(fetchShape, params, state)
    );
  });
  var promises = resourceList.map(function (_ref3) {
    var _ref4 = _slicedToArray(_ref3, 2),
        fetchShape = _ref4[0],
        params = _ref4[1];

    return (// eslint-disable-next-line react-hooks/rules-of-hooks
      useRetrieve(fetchShape, params)
    );
  }) // only wait on promises without results
  .map(function (p, i) {
    return !hasUsableData(denormalizedValues[i][1], resourceList[i][0]) && p;
  }); // throw first valid error

  for (var i = 0; i < resourceList.length; i++) {
    var _resourceList$i = _slicedToArray(resourceList[i], 2),
        _fetchShape = _resourceList$i[0],
        _params = _resourceList$i[1];

    var _denormalizedValues$i = _slicedToArray(denormalizedValues[i], 2),
        _ = _denormalizedValues$i[0],
        ready = _denormalizedValues$i[1]; // eslint-disable-next-line react-hooks/rules-of-hooks


    var error = useError(_fetchShape, _params, ready);
    if (error && !promises[i]) throw error;
  }

  var promise = useMemo(function () {
    var activePromises = promises.filter(function (p) {
      return p;
    });

    if (activePromises.length) {
      return Promise.all(activePromises);
    } // eslint-disable-next-line react-hooks/exhaustive-deps

  }, promises);
  if (promise) throw promise;
  return denormalizedValues.map(function (_ref5) {
    var _ref6 = _slicedToArray(_ref5, 1),
        denormalized = _ref6[0];

    return denormalized;
  });
}

export default function useResource() {
  for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    args[_key2] = arguments[_key2];
  }

  // this conditional use of hooks is ok as long as the structure of the arguments don't change
  if (Array.isArray(args[0])) {
    // TODO: provide type guard function to detect this
    // eslint-disable-next-line react-hooks/rules-of-hooks
    return useManyResources.apply(void 0, _toConsumableArray(args));
  }

  args = args; // TODO: make return types match up with the branching logic we put in here.
  // eslint-disable-next-line react-hooks/rules-of-hooks

  return useOneResource(args[0], args[1]);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9yZWFjdC1pbnRlZ3JhdGlvbi9ob29rcy91c2VSZXNvdXJjZS50cyJdLCJuYW1lcyI6WyJ1c2VEZW5vcm1hbGl6ZWQiLCJ1c2VSZXRyaWV2ZSIsInVzZUVycm9yIiwidXNlTWVtbyIsInVzZUNvbnRleHQiLCJTdGF0ZUNvbnRleHQiLCJoYXNVc2FibGVEYXRhIiwidXNlT25lUmVzb3VyY2UiLCJmZXRjaFNoYXBlIiwicGFyYW1zIiwibWF5YmVQcm9taXNlIiwic3RhdGUiLCJkZW5vcm1hbGl6ZWQiLCJyZWFkeSIsImVycm9yIiwidXNlTWFueVJlc291cmNlcyIsInJlc291cmNlTGlzdCIsImRlbm9ybWFsaXplZFZhbHVlcyIsIm1hcCIsInByb21pc2VzIiwicCIsImkiLCJsZW5ndGgiLCJfIiwicHJvbWlzZSIsImFjdGl2ZVByb21pc2VzIiwiZmlsdGVyIiwiUHJvbWlzZSIsImFsbCIsInVzZVJlc291cmNlIiwiYXJncyIsIkFycmF5IiwiaXNBcnJheSJdLCJtYXBwaW5ncyI6Ijs7QUFNQSxTQUFTQSxlQUFULFFBQWdDLHVCQUFoQztBQUNBLE9BQU9DLFdBQVAsTUFBd0IsZUFBeEI7QUFDQSxPQUFPQyxRQUFQLE1BQXFCLFlBQXJCO0FBQ0EsU0FBU0MsT0FBVCxFQUFrQkMsVUFBbEIsUUFBb0MsT0FBcEM7QUFDQSxTQUFTQyxZQUFULFFBQTZCLFlBQTdCO0FBRUEsT0FBT0MsYUFBUCxNQUEwQixpQkFBMUI7O0FBT0E7QUFDQSxTQUFTQyxjQUFULENBQ0VDLFVBREYsRUFFRUMsTUFGRixFQUdtRTtBQUNqRSxNQUFNQyxZQUFZLEdBQUdULFdBQVcsQ0FBQ08sVUFBRCxFQUFhQyxNQUFiLENBQWhDO0FBQ0EsTUFBTUUsS0FBSyxHQUFHUCxVQUFVLENBQUNDLFlBQUQsQ0FBeEI7O0FBRmlFLHlCQUduQ0wsZUFBZSxDQUFDUSxVQUFELEVBQWFDLE1BQWIsRUFBcUJFLEtBQXJCLENBSG9CO0FBQUE7QUFBQSxNQUcxREMsWUFIMEQ7QUFBQSxN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cUJlLElBQXJCLEVBQVA7QUFDRDs7QUFDREEsRUFBQUEsSUFBSSxHQUFHQSxJQUFQLENBUG1FLENBUW5FO0FBQ0E7O0FBQ0EsU0FBT3ZCLGNBQWMsQ0FBQ3VCLElBQUksQ0FBQyxDQUFELENBQUwsRUFBVUEsSUFBSSxDQUFDLENBQUQsQ0FBZCxDQUFyQjtBQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgUmVhZFNoYXBlLFxuICBTY2hlbWEsXG4gIERlbm9ybWFsaXplLFxuICBEZW5vcm1hbGl6ZU51bGxhYmxlLFxufSBmcm9tICd+L3Jlc291cmNlJztcbmltcG9ydCB7IHVzZURlbm9ybWFsaXplZCB9IGZyb20gJ34vc3RhdGUvc2VsZWN0b3JzJztcbmltcG9ydCB1c2VSZXRyaWV2ZSBmcm9tICcuL3VzZVJldHJpZXZlJztcbmltcG9ydCB1c2VFcnJvciBmcm9tICcuL3VzZUVycm9yJztcbmltcG9ydCB7IHVzZU1lbW8sIHVzZUNvbnRleHQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBTdGF0ZUNvbnRleHQgfSBmcm9tICd+L3JlYWN0LWludGVncmF0aW9uL2NvbnRleHQnO1xuXG5pbXBvcnQgaGFzVXNhYmxlRGF0YSBmcm9tICcuL2hhc1VzYWJsZURhdGEnO1xuXG50eXBlIFJlc291cmNlQXJnczxTIGV4dGVuZHMgU2NoZW1hLCBQYXJhbXMgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+PiA9IFtcbiAgUmVhZFNoYXBlPFMsIFBhcmFtcz4sXG4gIFBhcmFtcyB8IG51bGwsXG5dO1xuXG4vKiogc2luZ2xlIGZvcm0gcmVzb3VyY2UgKi9cbmZ1bmN0aW9uIHVzZU9uZVJlc291cmNlPFBhcmFtcyBleHRlbmRzIFJlYWRvbmx5PG9iamVjdD4sIFMgZXh0ZW5kcyBTY2hlbWE+KFxuICBmZXRjaFNoYXBlOiBSZWFkU2hhcGU8UywgUGFyYW1zPixcbiAgcGFyYW1zOiBQYXJhbXMgfCBudWxsLFxuKTogQ29uZE51bGw8dHlwZW9mIHBhcmFtcywgRGVub3JtYWxpemVOdWxsYWJsZTxTPiwgRGVub3JtYWxpemU8Uz4+IHtcbiAgY29uc3QgbWF5YmVQcm9taXNlID0gdXNlUmV0cmlldmUoZmV0Y2hTaGFwZSwgcGFyYW1zKTtcbiAgY29uc3Qgc3RhdGUgPSB1c2VDb250ZXh0KFN0YXRlQ29udGV4dCk7XG4gIGNvbnN0IFtkZW5vcm1hbGl6ZWQsIHJlYWR5XSA9IHVzZURlbm9ybWFsaXplZChmZXRjaFNoYXBlLCBwYXJhbXMsIHN0YXRlKTtcbiAgY29uc3QgZXJyb3IgPSB1c2VFcnJvcihmZXRjaFNoYXBlLCBwYXJhbXMsIHJlYWR5KTtcblxuICBpZiAoIWhhc1VzYWJsZURhdGEocmVhZHksIGZldGNoU2hhcGUpICYmIG1heWJlUHJvbWlzZSkgdGhyb3cgbWF5YmVQcm9taXNlO1xuICBpZiAoZXJyb3IpIHRocm93IGVycm9yO1xuXG4gIHJldHVybiBkZW5vcm1hbGl6ZWQgYXMgYW55O1xufVxuXG4vKiogbWFueSBmb3JtIHJlc291cmNlICovXG5mdW5jdGlvbiB1c2VNYW55UmVzb3VyY2VzPEEgZXh0ZW5kcyBSZXNvdXJjZUFyZ3M8YW55LCBhbnk+W10+KFxuICAuLi5yZXNvdXJjZUxpc3Q6IEFcbikge1xuICBjb25zdCBzdGF0ZSA9IHVzZUNvbnRleHQoU3RhdGVDb250ZXh0KTtcbiAgY29uc3QgZGVub3JtYWxpemVkVmFsdWVzID0gcmVzb3VyY2VMaXN0Lm1hcChcbiAgICA8UGFyYW1zIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiwgUyBleHRlbmRzIFNjaGVtYT4oW1xuICAgICAgZmV0Y2hTaGFwZSxcbiAgICAgIHBhcmFtcyxcbiAgICBdOiBSZXNvdXJjZUFyZ3M8UywgUGFyYW1zPikgPT5cbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSByZWFjdC1ob29rcy9ydWxlcy1vZi1ob29rc1xuICAgICAgdXNlRGVub3JtYWxpemVkKGZldGNoU2hhcGUsIHBhcmFtcywgc3RhdGUpLFxuICApO1xuICBjb25zdCBwcm9taXNlcyA9IHJlc291cmNlTGlzdFxuICAgIC5tYXAoKFtmZXRjaFNoYXBlLCBwYXJhbXNdKSA9PlxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gICAgICB1c2VSZXRyaWV2ZShmZXRjaFNoYXBlLCBwYXJhbXMpLFxuICAgIClcbiAgICAvLyBvbmx5IHdhaXQgb24gcHJvbWlzZXMgd2l0aG91dCByZXN1bHRzXG4gICAgLm1hcChcbiAgICAgIChwLCBpKSA9PlxuICAgICAgICAhaGFzVXNhYmxlRGF0YShkZW5vcm1hbGl6ZWRWYWx1ZXNbaV1bMV0sIHJlc291cmNlTGlzdFtpXVswXSkgJiYgcCxcbiAgICApO1xuXG4gIC8vIHRocm93IGZpcnN0IHZhbGlkIGVycm9yXG4gIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzb3VyY2VMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3QgW2ZldGNoU2hhcGUsIHBhcmFtc10gPSByZXNvdXJjZUxpc3RbaV07XG4gICAgY29uc3QgW18sIHJlYWR5XSA9IGRlbm9ybWFsaXplZFZhbHVlc1tpXTtcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvcnVsZXMtb2YtaG9va3NcbiAgICBjb25zdCBlcnJvciA9IHVzZUVycm9yKGZldGNoU2hhcGUsIHBhcmFtcywgcmVhZHkpO1xuICAgIGlmIChlcnJvciAmJiAhcHJvbWlzZXNbaV0pIHRocm93IGVycm9yO1xuICB9XG5cbiAgY29uc3QgcHJvbWlzZSA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGFjdGl2ZVByb21pc2VzID0gcHJvbWlzZXMuZmlsdGVyKHAgPT4gcCk7XG4gICAgaWYgKGFjdGl2ZVByb21pc2VzLmxlbmd0aCkge1xuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKGFjdGl2ZVByb21pc2VzKTtcbiAgICB9XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL2V4aGF1c3RpdmUtZGVwc1xuICB9LCBwcm9taXNlcyk7XG5cbiAgaWYgKHByb21pc2UpIHRocm93IHByb21pc2U7XG5cbiAgcmV0dXJuIGRlbm9ybWFsaXplZFZhbHVlcy5tYXAoKFtkZW5vcm1hbGl6ZWRdKSA9PiBkZW5vcm1hbGl6ZWQpO1xufVxuXG50eXBlIENvbmROdWxsPFAsIEEsIEI+ID0gUCBleHRlbmRzIG51bGwgPyBBIDogQjtcblxuLyoqIEVuc3VyZSBhIHJlc291cmNlIGlzIGF2YWlsYWJsZTsgc3VzcGVuZGluZyB0byBSZWFjdCB1bnRpbCBpdCBpcy4gKi9cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVzZVJlc291cmNlPFxuICBQIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIEIgZXh0ZW5kcyBSZWFkb25seTxvYmplY3QgfCBzdHJpbmc+IHwgdm9pZCxcbiAgUyBleHRlbmRzIFNjaGVtYVxuPihcbiAgZmV0Y2hTaGFwZTogUmVhZFNoYXBlPFMsIE5vbk51bGxhYmxlPFA+PixcbiAgcGFyYW1zOiBQLFxuKTogQ29uZE51bGw8UCwgRGVub3JtYWxpemVOdWxsYWJsZTxTPiwgRGVub3JtYWxpemU8Uz4+O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdXNlUmVzb3VyY2U8XG4gIFAxIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFMxIGV4dGVuZHMgU2NoZW1hXG4+KFxuICB2MTogW1JlYWRTaGFwZTxTMSwgTm9uTnVsbGFibGU8UDE+PiwgUDFdLFxuKTogW0NvbmROdWxsPFAxLCBEZW5vcm1hbGl6ZU51bGxhYmxlPFMxPiwgRGVub3JtYWxpemU8UzE+Pl07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VSZXNvdXJjZTxcbiAgUDEgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzEgZXh0ZW5kcyBTY2hlbWEsXG4gIFAyIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFMyIGV4dGVuZHMgU2NoZW1hXG4+KFxuICB2MTogW1JlYWRTaGFwZTxTMSwgTm9uTnVsbGFibGU8UDE+PiwgUDFdLFxuICB2MjogW1JlYWRTaGFwZTxTMiwgTm9uTnVsbGFibGU8UDI+PiwgUDJdLFxuKTogW1xuICBDb25kTnVsbDxQMSwgRGVub3JtYWxpemVOdWxsYWJsZTxTMT4sIERlbm9ybWFsaXplPFMxPj4sXG4gIENvbmROdWxsPFAyLCBEZW5vcm1hbGl6ZU51bGxhYmxlPFMyPiwgRGVub3JtYWxpemU8UzI+Pixcbl07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VSZXNvdXJjZTxcbiAgUDEgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzEgZXh0ZW5kcyBTY2hlbWEsXG4gIFAyIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFMyIGV4dGVuZHMgU2NoZW1hLFxuICBQMyBleHRlbmRzIFJlYWRvbmx5PG9iamVjdD4gfCBudWxsLFxuICBTMyBleHRlbmRzIFNjaGVtYVxuPihcbiAgdjE6IFtSZWFkU2hhcGU8UzEsIE5vbk51bGxhYmxlPFAxPj4sIFAxXSxcbiAgdjI6IFtSZWFkU2hhcGU8UzIsIE5vbk51bGxhYmxlPFAyPj4sIFAyXSxcbiAgdjM6IFtSZWFkU2hhcGU8UzMsIE5vbk51bGxhYmxlPFAzPj4sIFAzXSxcbik6IFtcbiAgQ29uZE51bGw8UDEsIERlbm9ybWFsaXplTnVsbGFibGU8UzE+LCBEZW5vcm1hbGl6ZTxTMT4+LFxuICBDb25kTnVsbDxQMiwgRGVub3JtYWxpemVOdWxsYWJsZTxTMj4sIERlbm9ybWFsaXplPFMyPj4sXG4gIENvbmROdWxsPFAzLCBEZW5vcm1hbGl6ZU51bGxhYmxlPFMzPiwgRGVub3JtYWxpemU8UzM+Pixcbl07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VSZXNvdXJjZTxcbiAgUDEgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzEgZXh0ZW5kcyBTY2hlbWEsXG4gIFAyIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFMyIGV4dGVuZHMgU2NoZW1hLFxuICBQMyBleHRlbmRzIFJlYWRvbmx5PG9iamVjdD4gfCBudWxsLFxuICBTMyBleHRlbmRzIFNjaGVtYSxcbiAgUDQgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzQgZXh0ZW5kcyBTY2hlbWFcbj4oXG4gIHYxOiBbUmVhZFNoYXBlPFMxLCBOb25OdWxsYWJsZTxQMT4+LCBQMV0sXG4gIHYyOiBbUmVhZFNoYXBlPFMyLCBOb25OdWxsYWJsZTxQMj4+LCBQMl0sXG4gIHYzOiBbUmVhZFNoYXBlPFMzLCBOb25OdWxsYWJsZTxQMz4+LCBQM10sXG4gIHY0OiBbUmVhZFNoYXBlPFM0LCBOb25OdWxsYWJsZTxQND4+LCBQNF0sXG4pOiBbXG4gIENvbmROdWxsPFAxLCBEZW5vcm1hbGl6ZU51bGxhYmxlPFMxPiwgRGVub3JtYWxpemU8UzE+PixcbiAgQ29uZE51bGw8UDIsIERlbm9ybWFsaXplTnVsbGFibGU8UzI+LCBEZW5vcm1hbGl6ZTxTMj4+LFxuICBDb25kTnVsbDxQMywgRGVub3JtYWxpemVOdWxsYWJsZTxTMz4sIERlbm9ybWFsaXplPFMzPj4sXG4gIENvbmROdWxsPFA0LCBEZW5vcm1hbGl6ZU51bGxhYmxlPFM0PiwgRGVub3JtYWxpemU8UzQ+Pixcbl07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VSZXNvdXJjZTxcbiAgUDEgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzEgZXh0ZW5kcyBTY2hlbWEsXG4gIFAyIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFMyIGV4dGVuZHMgU2NoZW1hLFxuICBQMyBleHRlbmRzIFJlYWRvbmx5PG9iamVjdD4gfCBudWxsLFxuICBTMyBleHRlbmRzIFNjaGVtYSxcbiAgUDQgZXh0ZW5kcyBSZWFkb25seTxvYmplY3Q+IHwgbnVsbCxcbiAgUzQgZXh0ZW5kcyBTY2hlbWEsXG4gIFA1IGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PiB8IG51bGwsXG4gIFM1IGV4dGVuZHMgU2NoZW1hXG4+KFxuICB2MTogW1JlYWRTaGFwZTxTMSwgTm9uTnVsbGFibGU8UDE+PiwgUDFdLFxuICB2MjogW1JlYWRTaGFwZTxTMiwgTm9uTnVsbGFibGU8UDI+PiwgUDJdLFxuICB2MzogW1JlYWRTaGFwZTxTMywgTm9uTnVsbGFibGU8UDM+PiwgUDNdLFxuICB2NDogW1JlYWRTaGFwZTxTNCwgTm9uTnVsbGFibGU8UDQ+PiwgUDRdLFxuICB2NTogW1JlYWRTaGFwZTxTNSwgTm9uTnVsbGFibGU8UDU+PiwgUDVdLFxuKTogW1xuICBDb25kTnVsbDxQMSwgRGVub3JtYWxpemVOdWxsYWJsZTxTMT4sIERlbm9ybWFsaXplPFMxPj4sXG4gIENvbmROdWxsPFAyLCBEZW5vcm1hbGl6ZU51bGxhYmxlPFMyPiwgRGVub3JtYWxpemU8UzI+PixcbiAgQ29uZE51bGw8UDMsIERlbm9ybWFsaXplTnVsbGFibGU8UzM+LCBEZW5vcm1hbGl6ZTxTMz4+LFxuICBDb25kTnVsbDxQNCwgRGVub3JtYWxpemVOdWxsYWJsZTxTND4sIERlbm9ybWFsaXplPFM0Pj4sXG4gIENvbmROdWxsPFA1LCBEZW5vcm1hbGl6ZU51bGxhYmxlPFM1PiwgRGVub3JtYWxpemU8UzU+Pixcbl07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB1c2VSZXNvdXJjZTxcbiAgUGFyYW1zIGV4dGVuZHMgUmVhZG9ubHk8b2JqZWN0PixcbiAgUyBleHRlbmRzIFNjaGVtYVxuPiguLi5hcmdzOiBSZXNvdXJjZUFyZ3M8UywgUGFyYW1zPiB8IFJlc291cmNlQXJnczxTLCBQYXJhbXM+W10pOiBhbnkge1xuICAvLyB0aGlzIGNvbmRpdGlvbmFsIHVzZSBvZiBob29rcyBpcyBvayBhcyBsb25nIGFzIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIGFyZ3VtZW50cyBkb24ndCBjaGFuZ2VcbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJnc1swXSkpIHtcbiAgICAvLyBUT0RPOiBwcm92aWRlIHR5cGUgZ3VhcmQgZnVuY3Rpb24gdG8gZGV0ZWN0IHRoaXNcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3QtaG9va3MvcnVsZXMtb2YtaG9va3NcbiAgICByZXR1cm4gdXNlTWFueVJlc291cmNlcyguLi4oYXJncyBhcyBSZXNvdXJjZUFyZ3M8UywgUGFyYW1zPltdKSk7XG4gIH1cbiAgYXJncyA9IGFyZ3MgYXMgUmVzb3VyY2VBcmdzPFMsIFBhcmFtcz47XG4gIC8vIFRPRE86IG1ha2UgcmV0dXJuIHR5cGVzIG1hdGNoIHVwIHdpdGggdGhlIGJyYW5jaGluZyBsb2dpYyB3ZSBwdXQgaW4gaGVyZS5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0LWhvb2tzL3J1bGVzLW9mLWhvb2tzXG4gIHJldHVybiB1c2VPbmVSZXNvdXJjZShhcmdzWzBdLCBhcmdzWzFdKTtcbn1cbiJdfQ==